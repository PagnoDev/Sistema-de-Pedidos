(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{2634:()=>{},6239:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>_});var a=s(5155),t=s(2115),d=s(2596);let n=e=>{let{variant:r="default",className:s,...t}=e;return(0,a.jsx)("button",{...t,className:(0,d.A)("px-4 py-2 rounded font-semibold transition",{default:"bg-blue-600 text-white hover:bg-blue-700",outline:"border border-blue-600 text-blue-600 hover:bg-blue-100"}[r],s)})};function o(e){return(0,a.jsx)("input",{...e,className:"border border-gray-300 rounded px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-400"})}function l(e){let{children:r}=e;return(0,a.jsx)("table",{className:"min-w-full border text-sm text-left",children:r})}function i(e){let{children:r}=e;return(0,a.jsx)("thead",{className:"bg-gray-100 font-semibold",children:r})}function c(e){let{children:r}=e;return(0,a.jsx)("tbody",{children:r})}function u(e){let{children:r}=e;return(0,a.jsx)("tr",{className:"border-b hover:bg-gray-50",children:r})}function h(e){let{children:r}=e;return(0,a.jsx)("th",{className:"px-4 py-2",children:r})}function x(e){let{children:r,...s}=e;return(0,a.jsx)("td",{...s,className:"px-4 py-2",children:r})}var p=s(6874),m=s.n(p),j=s(6072),b=s(7772),N=s(6052),g=s.n(N),v=s(5695);let f=e=>fetch(e).then(e=>e.json()),y=e=>fetch(e).then(e=>e.json().then());function _(){let[e,r]=(0,t.useState)({id_usuario:"",status:"",orderBy:"data_pedido",order:"desc"}),[s,d]=(0,t.useState)(1),p=(e,s)=>{r(r=>({...r,[e]:s}))},N=g().stringify({page:s,orderBy:e.orderBy,order:e.order,status:e.status||void 0,id_usuario:e.id_usuario||void 0},{addQueryPrefix:!0}),{data:_,error:E,isLoading:w}=(0,j.Ay)("/api/pedidos/list".concat(N),y),[C,A]=(0,t.useState)(""),[S,D]=(0,t.useState)([{id_produto:"",quantidade:1}]),{data:q,error:k,isLoading:O}=(0,j.Ay)("/api/produtos/list",f),P=e=>{let r=[...S];r.splice(e,1),D(r)},T=(e,r,s)=>{let a=[...S];a[e][r]=s,D(a)},R=async()=>{try{let e=S.filter(e=>e.id_produto&&e.quantidade>0).map(e=>({id_produto:Number(e.id_produto),quantidade:Number(e.quantidade)}));if(0===e.length)return void A("Preencha todos os campos.");let r=await fetch("/api/pedidos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itens:e})}),s=await r.json();if(!r.ok){let e=s.erro||s.message||"Erro ao realizar pedido.";A("❌ ".concat(e));return}A("✅ Pedido realizado com sucesso!"),D([{id_produto:"",quantidade:1}])}catch(s){var e,r;A((null==(r=s.response)||null==(e=r.data)?void 0:e.message)||"Erro ao realizar pedido.")}},B=(0,v.useRouter)(),I=async()=>{await fetch("/api/login",{method:"DELETE"}),B.push("/login")};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"w-full bg-white shadow p-4 text-center font-bold text-xl",children:"NAVBAR"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 p-6",children:[(0,a.jsxs)("section",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,a.jsx)(n,{variant:"outline",onClick:()=>{D([...S,{id_produto:"",quantidade:1}])},className:"mb-4 text-blue-600 hover:underline",type:"button",children:"ADD +"}),(0,a.jsx)(n,{className:"flex-1",onClick:R,children:"ENVIAR PEDIDO"}),(0,a.jsx)(n,{className:"ml-auto bg-red-600 hover:bg-red-700 text-white",onClick:I,children:"Sair"})]}),S.map((e,r)=>(0,a.jsxs)("div",{className:"flex gap-2 mb-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm",children:"Produto"}),O?(0,a.jsx)("p",{children:"Carregando produtos..."}):k?(0,a.jsx)("p",{className:"text-red-600",children:"Erro ao carregar produtos."}):(0,a.jsxs)("select",{className:"w-full border p-2 rounded",value:e.id_produto,onChange:e=>T(r,"id_produto",Number(e.target.value)),children:[(0,a.jsx)("option",{value:"",children:"Selecione um produto"}),Array.isArray(q)&&[...q].sort((e,r)=>e.nome.localeCompare(r.nome)).map(e=>(0,a.jsxs)("option",{value:e.id,disabled:e.quantidade_estoque<=0,children:[e.nome," ",e.quantidade_estoque<=0?"(Sem estoque)":""]},e.id))]})]}),(0,a.jsxs)("div",{className:"w-32",children:[(0,a.jsx)("label",{className:"block text-sm",children:"Qtd"}),(0,a.jsx)("input",{type:"number",className:"w-full border p-2 rounded",value:e.quantidade,onChange:e=>T(r,"quantidade",Number(e.target.value))})]}),(0,a.jsx)("button",{onClick:()=>P(r),className:"text-red-600 hover:underline",type:"button",children:"Remover"})]},r)),C&&(0,a.jsx)("p",{className:"mt-4 text-green-600",children:C})]}),(0,a.jsxs)("section",{className:"bg-white shadow p-4 rounded",children:[(0,a.jsx)("h2",{className:"text-center text-xl font-bold mb-4",children:"PEDIDOS"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2",children:[(0,a.jsx)(o,{placeholder:"Filtrar por id do usu\xe1rio",value:e.id_usuario,onChange:e=>p("id_usuario",e.target.value)}),(0,a.jsxs)("select",{value:e.status,onChange:e=>p("status",e.target.value),className:"border p-2 rounded",children:[(0,a.jsx)("option",{value:"",children:"Todos"}),Object.values(b.W).map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))]}),(0,a.jsxs)("select",{value:e.orderBy,onChange:e=>p("orderBy",e.target.value),className:"border rounded p-2",children:[(0,a.jsx)("option",{value:"data_pedido",children:"Data"}),(0,a.jsx)("option",{value:"total_valor",children:"Total"})]}),(0,a.jsxs)("select",{value:e.order,onChange:e=>p("direction",e.target.value),className:"border rounded p-2",children:[(0,a.jsx)("option",{value:"asc",children:"Ascendente"}),(0,a.jsx)("option",{value:"desc",children:"Descendente"})]})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(l,{children:[(0,a.jsx)(i,{children:(0,a.jsxs)(u,{children:[(0,a.jsx)(h,{children:"ID Usu\xe1rio"}),(0,a.jsx)(h,{children:"Data"}),(0,a.jsx)(h,{children:"Total"}),(0,a.jsx)(h,{children:"Status"}),(0,a.jsx)(h,{children:"A\xe7\xf5es"})]})}),(0,a.jsx)(c,{children:E?(0,a.jsx)(u,{children:(0,a.jsx)("td",{colSpan:5,className:"text-red-600 text-center",children:"Erro ao carregar pedidos."})}):w?(0,a.jsx)(u,{children:(0,a.jsx)("td",{colSpan:5,className:"text-center",children:"Carregando pedidos..."})}):Array.isArray(_)&&0!==_.length?_.map(e=>(0,a.jsxs)(u,{children:[(0,a.jsx)(x,{children:e.id_usuario}),(0,a.jsx)(x,{children:e.data_pedido}),(0,a.jsxs)(x,{children:["R$ ",Number(e.total_valor).toFixed(2)]}),(0,a.jsx)(x,{children:e.status}),(0,a.jsx)(x,{children:(0,a.jsx)(m(),{href:"/pedido/".concat(e.id),children:"+"})})]},e.id)):(0,a.jsx)(u,{children:(0,a.jsx)("td",{colSpan:5,className:"text-center",children:"Nenhum pedido encontrado."})})})]})})]})]})]})}},7245:(e,r,s)=>{Promise.resolve().then(s.bind(s,6239))},7772:(e,r,s)=>{"use strict";s.d(r,{W:()=>a});var a=function(e){return e.PENDENTE="pendente",e.PROCESSANDO="processando",e.ENVIADO="enviado",e.ENTREGUE="entregue",e.CANCELADO="cancelado",e}({})}},e=>{var r=r=>e(e.s=r);e.O(0,[498,486,441,684,358],()=>r(7245)),_N_E=e.O()}]);